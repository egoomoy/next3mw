# kafka구성하기

### 1. 구성 이유

- 인코딩 기능을 구현하면서, 아키텍쳐를 고민하다보니 필요성을 느낌
- 인코딩 대상 파일을 큐에 쌓아두고, 완료 시 클리어 해야한다고 생각함
- 스프링 어플리케이션 안에서 큐/배치/쓰레드를 이용해서 구현하면, 구현 난이도나
  코드 복잡도가 기하 급수적으로 높아질 것으로 예상함
- 또한, 정합성을 보장할 수 없다고 생각함
- 그리고, 내부 파라미터(배치나 큐에 관련된)나 상태를 볼 수 없다고 생각함

### 2. 구성 방법

- 우선 로컬에서는 도커 컴포즈를 이용해서 간단하게 사용하기로
- 참고 문서는 https://www.sktenterprise.com/bizInsight/blogDetail/dev/2552

### 3. 구성 후 활용 방안

- 인코딩 큐에 사용
- 로그 수집에 사용할 계획 => 각 어플리케이션에 사이드카로 fluent를 같이 배포
- 로그 수집을 카프카로 중앙화한 후 엘라스틱서치까지 연계

### 이슈 사항

- 운영 서버에 직접 카프카를 구성해야할 수도 있는 약간의 리스크
- 일단 해보자.
- 여기까지 도커 컴포즈로 했을 때 23/12/20 16:40
- 문제는 컨테이너 안에서 도커로 올라간 카프카에 접속을 못한다.
- 컨테이너 안에서 외부 포트로 접속되는 걸 확인했지만, 도커 컴포즈로 배포하는 과정에서 KAFKA_ADVERTISED_LISTENERS 를 이해하지 못하는 듯..

- 231225
- 헬름 차트로 다시
